#include <stdio.h>
#include <string.h>

#ifndef DUMMY_TEST_H
#define DUMMY_TEST_H

#if __STDC_VERSION__ >= 201112L
#include <time.h>
#define _DUMMY_CLOCK_T struct timespec
#define _DUMMY_GET_TIME(t) timespec_get(&t, TIME_UTC)
#define _DUMMY_GET_NS(t) ((t).tv_nsec)
#elif __STDC_VERSION__ == 199901L
#include <time.h>
#include <stdint.h>

#define _DUMMY_CLOCK_T clock_t
#define _DUMMY_GET_TIME(t) ((t) = clock())
#define _DUMMY_GET_NS(t) (((t) * 1000000000L) / CLOCKS_PER_SEC)
#else
#include <time.h>

#define _DUMMY_CLOCK_T clock_t
#define _DUMMY_GET_TIME(t) ((t) = clock())
#define _DUMMY_GET_NS(t) (((t) * 1000000000L) / CLOCKS_PER_SEC)
#endif

#if __STDC_VERSION__ >= 199901L
#define DUMMY_API static inline
#define _DUMMY_API static inline
#define dummy_snprintf(buffer, size, format) snprintf(buffer, size, format)
#define FUNC __func__
#else
#define DUMMY_API static
#define _DUMMY_API static
#define dummy_snprintf(buffer, size, format) sprintf(buffer, format)
#define FUNC "unknow function - build with C99 or greater"
#endif

/**
 * Internal Macros, Constants, Functions and variables
 */
#define _DUMMY_TX_RED "\033[31m"
#define _DUMMY_TX_GREEN "\033[32m"
#define _DUMMY_TX_YELLOW "\033[33m"
#define _DUMMY_TX_BLUE "\033[34m"
#define _DUMMY_TX_ITALIC "\033[3m"
#define _DUMMY_TX_BOLD "\033[1m"
#define _DUMMY_TX_RESET "\033[0m"
#define _DUMMY_BG_RED "\033[41m"
#define _DUMMY_BG_GREEN "\033[42m"
#define _DUMMY_BG_YELLOW "\033[43m"
#define _DUMMY_BG_BLUE "\033[44m"
#define _DUMMY_BG_MAGENTA "\033[45m"
#define _DUMMY_BG_WHITE "\033[47m"
#define _DUMMY_BG_BLACK "\033[40m"
#define _DUMMY_TX_UNDERLINE "\033[4m"
#define _DUMMY_STRINGIFY(tok) #tok
#define _TAB_SUITE_N 42
#define _TAB_TEST_N 25

// typedef struct _dummy_memory{
//     size_t mem_size;
//     void* ptr_copy;
// }_dummy_memory;

// static _dummy_memory* _dummy_mem_array = NULL;


#define _DUMMY_ERROR(code)                                                                                                                                                                                                                                                                                         \
    do                                                                                                                                                                                                                                                                                                             \
    {                                                                                                                                                                                                                                                                                                              \
        fprintf(stderr,                                                                                                                                                                                                                                                                                            \
                _DUMMY_TX_RED _DUMMY_TX_BOLD "Wrong result for :" _DUMMY_TX_RESET " %s  \n $ " _DUMMY_TX_YELLOW "%s ->" _DUMMY_TX_RESET _DUMMY_TX_ITALIC " line:" _DUMMY_TX_RESET " " _DUMMY_BG_BLUE "%d" _DUMMY_TX_RESET "," _DUMMY_TX_ITALIC " file: " _DUMMY_TX_RESET _DUMMY_BG_BLUE "%s" _DUMMY_TX_RESET "\n", \
                FUNC, code, __LINE__, __FILE__);                                                                                                                                                                                                                                                                   \
    } while (0)

_DUMMY_API char *_internal_calc_tab(const char *str, size_t n)
{
    size_t l = n - strlen(str);
    char *s = malloc(l + 1);

    if (!s)
        _DUMMY_ERROR("malloc");

    memset(s, ' ', l);
    s[l] = '\0';

    return s;
}

/**
 * Types
 */
typedef struct dummy_code_t
{
    int code;
    char buffer[512];
} dummy_code_t;

typedef dummy_code_t (*Dummy_test_function)();

typedef struct dummy_single_test
{
    Dummy_test_function test;
    const char *name;
} Dummy_single_test;

/**
 * Public Macros
 */
#define DUMMY_TEST_SUCCESS 1
#define DUMMY_TEST_SKIP 2
#define DUMMY_TEST_ERROR 0

#define DUMMY_ASSERT_EQ(actual, expected)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
    do                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
        int match = actual == expected;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \
        dummy_code_t buff = {.code = match ? DUMMY_TEST_SUCCESS : DUMMY_TEST_ERROR, .buffer = {0}};                                                                                                                                                                                                                                                                                                                                                                                                                            \
        if (!match)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
            snprintf(buff.buffer, sizeof(buff.buffer), _DUMMY_TX_RED _DUMMY_TX_BOLD "              Assert failed: " _DUMMY_TX_RESET "[" _DUMMY_STRINGIFY(actual) " != " _DUMMY_TX_RESET _DUMMY_STRINGIFY(expected) "] \n              " _DUMMY_TX_UNDERLINE _DUMMY_TX_YELLOW "%s ->" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE _DUMMY_TX_ITALIC " line:" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE " %d" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "," _DUMMY_TX_ITALIC " file: " _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "%s" _DUMMY_TX_RESET "\n", \
                     FUNC, __LINE__, __FILE__);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
        return buff;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \
    } while (0)

#define DUMMY_ASSERT_NOT_EQ(actual, expected)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \
    do                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
        int match = actual != expected;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \
        dummy_code_t buff = {.code = match ? DUMMY_TEST_SUCCESS : DUMMY_TEST_ERROR, .buffer = {0}};                                                                                                                                                                                                                                                                                                                                                                                                                            \
        if (!match)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
            snprintf(buff.buffer, sizeof(buff.buffer), _DUMMY_TX_RED _DUMMY_TX_BOLD "              Assert failed: " _DUMMY_TX_RESET "[" _DUMMY_STRINGIFY(actual) " == " _DUMMY_TX_RESET _DUMMY_STRINGIFY(expected) "] \n              " _DUMMY_TX_UNDERLINE _DUMMY_TX_YELLOW "%s ->" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE _DUMMY_TX_ITALIC " line:" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE " %d" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "," _DUMMY_TX_ITALIC " file: " _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "%s" _DUMMY_TX_RESET "\n", \
                     FUNC, __LINE__, __FILE__);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
        return buff;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \
    } while (0)

#define DUMMY_ASSERT_EQ_NULL(actual)                                                                                                                                                                                                                                                                                                                                                                                                                                         \
    do                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \
    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \
        int match = actual == NULL;                                                                                                                                                                                                                                                                                                                                                                                                                                          \
        dummy_code_t buff = {.code = match ? DUMMY_TEST_SUCCESS : DUMMY_TEST_ERROR, .buffer = {0}};                                                                                                                                                                                                                                                                                                                                                                          \
        if (!match)                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \
            snprintf(buff.buffer, sizeof(buff.buffer), _DUMMY_TX_RED _DUMMY_TX_BOLD "              Assert failed: " _DUMMY_TX_RESET "[" _DUMMY_STRINGIFY(actual) " != " _DUMMY_TX_RESET "NULL"                                                                                                                                                                                                                                                                               \
                                                                                                                                                                 "] \n              " _DUMMY_TX_UNDERLINE _DUMMY_TX_YELLOW "%s ->" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE _DUMMY_TX_ITALIC " line:" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE " %d" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "," _DUMMY_TX_ITALIC " file: " _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "%s" _DUMMY_TX_RESET "\n", \
                     FUNC, __LINE__, __FILE__);                                                                                                                                                                                                                                                                                                                                                                                                                              \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \
        return buff;                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
    } while (0)

#define DUMMY_ASSERT_NOT_EQ_NULL(actual)                                                                                                                                                                                                                                                                                                                                                                                                                                     \
    do                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \
    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \
        int match = actual != NULL;                                                                                                                                                                                                                                                                                                                                                                                                                                          \
        dummy_code_t buff = {.code = match ? DUMMY_TEST_SUCCESS : DUMMY_TEST_ERROR, .buffer = {0}};                                                                                                                                                                                                                                                                                                                                                                          \
        if (!match)                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \
            snprintf(buff.buffer, sizeof(buff.buffer), _DUMMY_TX_RED _DUMMY_TX_BOLD "              Assert failed: " _DUMMY_TX_RESET "[" _DUMMY_STRINGIFY(actual) " == " _DUMMY_TX_RESET "NULL"                                                                                                                                                                                                                                                                               \
                                                                                                                                                                 "] \n              " _DUMMY_TX_UNDERLINE _DUMMY_TX_YELLOW "%s ->" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE _DUMMY_TX_ITALIC " line:" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE " %d" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "," _DUMMY_TX_ITALIC " file: " _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "%s" _DUMMY_TX_RESET "\n", \
                     FUNC, __LINE__, __FILE__);                                                                                                                                                                                                                                                                                                                                                                                                                              \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \
        return buff;                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
    } while (0)

#define DUMMY_ASSERT_EQ_STRING(actual, expected)                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \
    do                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
        int match = !strcmp(actual, expected);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \
        dummy_code_t buff = {.code = match ? DUMMY_TEST_SUCCESS : DUMMY_TEST_ERROR, .buffer = {0}};                                                                                                                                                                                                                                                                                                                                                                                                                            \
        if (!match)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
            snprintf(buff.buffer, sizeof(buff.buffer), _DUMMY_TX_RED _DUMMY_TX_BOLD "              Assert failed: " _DUMMY_TX_RESET "[" _DUMMY_STRINGIFY(actual) " != " _DUMMY_TX_RESET _DUMMY_STRINGIFY(expected) "] \n              " _DUMMY_TX_UNDERLINE _DUMMY_TX_YELLOW "%s ->" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE _DUMMY_TX_ITALIC " line:" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE " %d" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "," _DUMMY_TX_ITALIC " file: " _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "%s" _DUMMY_TX_RESET "\n", \
                     FUNC, __LINE__, __FILE__);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
        return buff;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \
    } while (0)

#define DUMMY_ASSERT_NOT_EQ_STRING(actual, expected)                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \
    do                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
        int match = strcmp(actual, expected);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \
        dummy_code_t buff = {.code = match ? DUMMY_TEST_SUCCESS : DUMMY_TEST_ERROR, .buffer = {0}};                                                                                                                                                                                                                                                                                                                                                                                                                            \
        if (!match)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
            snprintf(buff.buffer, sizeof(buff.buffer), _DUMMY_TX_RED _DUMMY_TX_BOLD "              Assert failed: " _DUMMY_TX_RESET "[" _DUMMY_STRINGIFY(actual) " == " _DUMMY_TX_RESET _DUMMY_STRINGIFY(expected) "] \n              " _DUMMY_TX_UNDERLINE _DUMMY_TX_YELLOW "%s ->" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE _DUMMY_TX_ITALIC " line:" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE " %d" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "," _DUMMY_TX_ITALIC " file: " _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "%s" _DUMMY_TX_RESET "\n", \
                     FUNC, __LINE__, __FILE__);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
        return buff;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \
    } while (0)

#define DUMMY_ASSERT_IN(actual, array, lenght)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \
    do                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \
    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \
        int match = 0;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \
        for (int i = 0; i < lenght; i++)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \
            if (array[i] == actual)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \
            {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
                match = 1;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \
                break;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \
            }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \
        dummy_code_t buff = {.code = match ? DUMMY_TEST_SUCCESS : DUMMY_TEST_ERROR, .buffer = {0}};                                                                                                                                                                                                                                                                                                                                                                                                                                   \
        if (!match)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \
            snprintf(buff.buffer, sizeof(buff.buffer), _DUMMY_TX_RED _DUMMY_TX_BOLD "              Assert failed: " _DUMMY_TX_RESET "[" _DUMMY_STRINGIFY(actual) " is not in  " _DUMMY_TX_RESET _DUMMY_STRINGIFY(array) "[]] \n              " _DUMMY_TX_UNDERLINE _DUMMY_TX_YELLOW "%s ->" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE _DUMMY_TX_ITALIC " line:" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE " %d" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "," _DUMMY_TX_ITALIC " file: " _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "%s" _DUMMY_TX_RESET "\n", \
                     FUNC, __LINE__, __FILE__);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \
        return buff;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \
    } while (0)

#define DUMMY_ASSERT_NOT_IN(actual, array, lenght)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \
    do                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \
    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \
        int match = 0;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \
        for (int i = 0; i < lenght; i++)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
            if (array[i] == actual)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \
                match = 0;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \
            else                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \
                match = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
        dummy_code_t buff = {.code = match ? DUMMY_TEST_SUCCESS : DUMMY_TEST_ERROR, .buffer = {0}};                                                                                                                                                                                                                                                                                                                                                                                                                               \
        if (!match)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
            snprintf(buff.buffer, sizeof(buff.buffer), _DUMMY_TX_RED _DUMMY_TX_BOLD "              Assert failed: " _DUMMY_TX_RESET "[" _DUMMY_STRINGIFY(actual) " is in  " _DUMMY_TX_RESET _DUMMY_STRINGIFY(array) "[]] \n              " _DUMMY_TX_UNDERLINE _DUMMY_TX_YELLOW "%s ->" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE _DUMMY_TX_ITALIC " line:" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE " %d" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "," _DUMMY_TX_ITALIC " file: " _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "%s" _DUMMY_TX_RESET "\n", \
                     FUNC, __LINE__, __FILE__);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
        return buff;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \
    } while (0)

#define DUMMY_ASSERT_TRUE(actual)                                                                                                                                                                                                                                                                                                                                                                                                                                            \
    do                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \
    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \
        int match = actual == 1;                                                                                                                                                                                                                                                                                                                                                                                                                                             \
        dummy_code_t buff = {.code = match ? DUMMY_TEST_SUCCESS : DUMMY_TEST_ERROR, .buffer = {0}};                                                                                                                                                                                                                                                                                                                                                                          \
        if (!match)                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \
            snprintf(buff.buffer, sizeof(buff.buffer), _DUMMY_TX_RED _DUMMY_TX_BOLD "              Assert failed: " _DUMMY_TX_RESET "[" _DUMMY_STRINGIFY(actual) " !=  TRUE"                                                                                                                                                                                                                                                                                                 \
                                                                                                                                                                 "] \n              " _DUMMY_TX_UNDERLINE _DUMMY_TX_YELLOW "%s ->" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE _DUMMY_TX_ITALIC " line:" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE " %d" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "," _DUMMY_TX_ITALIC " file: " _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "%s" _DUMMY_TX_RESET "\n", \
                     FUNC, __LINE__, __FILE__);                                                                                                                                                                                                                                                                                                                                                                                                                              \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \
        return buff;                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
    } while (0)

#define DUMMY_ASSERT_FALSE(actual)                                                                                                                                                                                                                                                                                                                                                                                                                                           \
    do                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \
    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \
        int match = actual != 1;                                                                                                                                                                                                                                                                                                                                                                                                                                             \
        dummy_code_t buff = {.code = match ? DUMMY_TEST_SUCCESS : DUMMY_TEST_ERROR, .buffer = {0}};                                                                                                                                                                                                                                                                                                                                                                          \
        if (!match)                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \
            snprintf(buff.buffer, sizeof(buff.buffer), _DUMMY_TX_RED _DUMMY_TX_BOLD "              Assert failed: " _DUMMY_TX_RESET "[" _DUMMY_STRINGIFY(actual) " !=  FALSE"                                                                                                                                                                                                                                                                                                \
                                                                                                                                                                 "] \n              " _DUMMY_TX_UNDERLINE _DUMMY_TX_YELLOW "%s ->" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE _DUMMY_TX_ITALIC " line:" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE " %d" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "," _DUMMY_TX_ITALIC " file: " _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "%s" _DUMMY_TX_RESET "\n", \
                     FUNC, __LINE__, __FILE__);                                                                                                                                                                                                                                                                                                                                                                                                                              \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \
        return buff;                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
    } while (0)

#define DUMMY_ASSERT_GREATER(actual, expected)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \
    do                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
        int match = actual > expected;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
        dummy_code_t buff = {.code = match ? DUMMY_TEST_SUCCESS : DUMMY_TEST_ERROR, .buffer = {0}};                                                                                                                                                                                                                                                                                                                                                                                                                            \
        if (!match)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
            snprintf(buff.buffer, sizeof(buff.buffer), _DUMMY_TX_RED _DUMMY_TX_BOLD "              Assert failed: " _DUMMY_TX_RESET "[" _DUMMY_STRINGIFY(actual) " <= " _DUMMY_TX_RESET _DUMMY_STRINGIFY(expected) "] \n              " _DUMMY_TX_UNDERLINE _DUMMY_TX_YELLOW "%s ->" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE _DUMMY_TX_ITALIC " line:" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE " %d" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "," _DUMMY_TX_ITALIC " file: " _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "%s" _DUMMY_TX_RESET "\n", \
                     FUNC, __LINE__, __FILE__);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
        return buff;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \
    } while (0)

#define DUMMY_ASSERT_GREATER_EQ(actual, expected)                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \
    do                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \
    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
        int match = actual >= expected;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \
        dummy_code_t buff = {.code = match ? DUMMY_TEST_SUCCESS : DUMMY_TEST_ERROR, .buffer = {0}};                                                                                                                                                                                                                                                                                                                                                                                                                           \
        if (!match)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \
            snprintf(buff.buffer, sizeof(buff.buffer), _DUMMY_TX_RED _DUMMY_TX_BOLD "              Assert failed: " _DUMMY_TX_RESET "[" _DUMMY_STRINGIFY(actual) " < " _DUMMY_TX_RESET _DUMMY_STRINGIFY(expected) "] \n              " _DUMMY_TX_UNDERLINE _DUMMY_TX_YELLOW "%s ->" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE _DUMMY_TX_ITALIC " line:" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE " %d" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "," _DUMMY_TX_ITALIC " file: " _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "%s" _DUMMY_TX_RESET "\n", \
                     FUNC, __LINE__, __FILE__);                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \
        return buff;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
    } while (0)

#define DUMMY_ASSERT_LESS(actual, expected)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \
    do                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
        int match = actual < expected;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
        dummy_code_t buff = {.code = match ? DUMMY_TEST_SUCCESS : DUMMY_TEST_ERROR, .buffer = {0}};                                                                                                                                                                                                                                                                                                                                                                                                                            \
        if (!match)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
            snprintf(buff.buffer, sizeof(buff.buffer), _DUMMY_TX_RED _DUMMY_TX_BOLD "              Assert failed: " _DUMMY_TX_RESET "[" _DUMMY_STRINGIFY(actual) " >= " _DUMMY_TX_RESET _DUMMY_STRINGIFY(expected) "] \n              " _DUMMY_TX_UNDERLINE _DUMMY_TX_YELLOW "%s ->" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE _DUMMY_TX_ITALIC " line:" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE " %d" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "," _DUMMY_TX_ITALIC " file: " _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "%s" _DUMMY_TX_RESET "\n", \
                     FUNC, __LINE__, __FILE__);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
        return buff;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \
    } while (0)

#define DUMMY_ASSERT_LESS_EQ(actual, expected)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \
    do                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \
    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
        int match = actual <= expected;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \
        dummy_code_t buff = {.code = match ? DUMMY_TEST_SUCCESS : DUMMY_TEST_ERROR, .buffer = {0}};                                                                                                                                                                                                                                                                                                                                                                                                                           \
        if (!match)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \
            snprintf(buff.buffer, sizeof(buff.buffer), _DUMMY_TX_RED _DUMMY_TX_BOLD "              Assert failed: " _DUMMY_TX_RESET "[" _DUMMY_STRINGIFY(actual) " > " _DUMMY_TX_RESET _DUMMY_STRINGIFY(expected) "] \n              " _DUMMY_TX_UNDERLINE _DUMMY_TX_YELLOW "%s ->" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE _DUMMY_TX_ITALIC " line:" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE " %d" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "," _DUMMY_TX_ITALIC " file: " _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "%s" _DUMMY_TX_RESET "\n", \
                     FUNC, __LINE__, __FILE__);                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \
        return buff;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
    } while (0)

#define DUMMY_ASSERT_EQ_ARRAY(actual, expected, lenght)                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \
    do                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \
    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \
        int match = 0;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \
        for (int i = 0; i < lenght; i++)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
            if (actual[i] == expected[i])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
            {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
                match = 1;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
            }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
            else                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \
            {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
                match = 0;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
                break;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \
            }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
        dummy_code_t buff = {.code = match ? DUMMY_TEST_SUCCESS : DUMMY_TEST_ERROR, .buffer = {0}};                                                                                                                                                                                                                                                                                                                                                                                                                                \
        if (!match)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
            snprintf(buff.buffer, sizeof(buff.buffer), _DUMMY_TX_RED _DUMMY_TX_BOLD "              Assert failed: " _DUMMY_TX_RESET "[" _DUMMY_STRINGIFY(actual) "[] != " _DUMMY_TX_RESET _DUMMY_STRINGIFY(expected) "[]] \n              " _DUMMY_TX_UNDERLINE _DUMMY_TX_YELLOW "%s ->" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE _DUMMY_TX_ITALIC " line:" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE " %d" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "," _DUMMY_TX_ITALIC " file: " _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "%s" _DUMMY_TX_RESET "\n", \
                     FUNC, __LINE__, __FILE__);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
        return buff;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \
    } while (0)

#define DUMMY_ASSERT_NOT_EQ_ARRAY(actual, expected, lenght)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \
    do                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \
    {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \
        int match = 0;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \
        for (int i = 0; i < lenght; i++)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
            if (actual[i] == expected[i])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
            {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
                match = 0;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
            }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
            else                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \
            {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
                match = 0;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \
            }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
        dummy_code_t buff = {.code = match ? DUMMY_TEST_SUCCESS : DUMMY_TEST_ERROR, .buffer = {0}};                                                                                                                                                                                                                                                                                                                                                                                                                                \
        if (!match)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
            snprintf(buff.buffer, sizeof(buff.buffer), _DUMMY_TX_RED _DUMMY_TX_BOLD "              Assert failed: " _DUMMY_TX_RESET "[" _DUMMY_STRINGIFY(actual) "[] == " _DUMMY_TX_RESET _DUMMY_STRINGIFY(expected) "[]] \n              " _DUMMY_TX_UNDERLINE _DUMMY_TX_YELLOW "%s ->" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE _DUMMY_TX_ITALIC " line:" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE " %d" _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "," _DUMMY_TX_ITALIC " file: " _DUMMY_TX_RESET _DUMMY_TX_UNDERLINE "%s" _DUMMY_TX_RESET "\n", \
                     FUNC, __LINE__, __FILE__);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \
        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \
        return buff;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \
    } while (0)

#define DUMMY_END                                                        \
    dummy_code_t end_buff = {.code = DUMMY_TEST_SUCCESS, .buffer = {0}}; \
    return end_buff;

#define DUMMY_SKIP_HERE                                                \
    dummy_code_t skip_buff = {.code = DUMMY_TEST_SKIP, .buffer = {0}}; \
    return skip_buff;

/** Public Function */
DUMMY_API void print_logo()
{
    puts(_DUMMY_TX_BOLD
        "    _____                                    _______        _   \n"
        "   |  __ \\                                  |__   __|      | |  \n"
        "   | |  | |_   _ _ __ ___  _ __ ___  _   _     | | ___  ___| |_ \n"
        "   | |  | | | | | '_ ` _ \\| '_ ` _ \\| | | |    | |/ _ \\/ __| __|\n"
        "   | |__| | |_| | | | | | | | | | | | |_| |    | |  __/\\__ \\ |_ \n"
        "   |_____/ \\__,_|_| |_| |_|_| |_| |_|\\__, |    |_|\\___||___/\\__|\n"
        "                                       _/ |                     \n"
    );
    puts("                                     |___/                      \n" _DUMMY_TX_RESET);
}

/**
 * Global variables
 */


DUMMY_API void dummy_test_suite(Dummy_single_test tests[], int lenght, const char *name)
{
    dummy_code_t local_code;
    int local_state;
    long int diff_ns;
    int n_tests = 0;
    _DUMMY_CLOCK_T before;
    _DUMMY_CLOCK_T after;
    char *tab;
    int i;

    char *tab_name = _internal_calc_tab(name, _TAB_SUITE_N);
    printf(_DUMMY_TX_BOLD _DUMMY_BG_BLUE "SUITE" _DUMMY_TX_RESET _DUMMY_BG_BLUE "                   %s %s" _DUMMY_TX_RESET "\n", name, tab_name);
    puts("-------------------------------------------------------------------");

    for (i = 0; i < lenght; i++)
    {
        _DUMMY_GET_TIME(before);
        local_code = tests[i].test();
        _DUMMY_GET_TIME(after);
        local_state = local_code.code;
        diff_ns = (int)_DUMMY_GET_NS(after) - _DUMMY_GET_NS(before);
        tab = _internal_calc_tab(tests[i].name, _TAB_TEST_N);

        switch (local_state)
        {
        case DUMMY_TEST_SUCCESS:
            printf(_DUMMY_BG_GREEN _DUMMY_TX_BOLD "%d.       PASS " _DUMMY_TX_RESET _DUMMY_TX_ITALIC "          %s %s" _DUMMY_TX_RESET " %ldns\n", i + 1, tests[i].name, tab, diff_ns);
            n_tests++;
            continue;
        case DUMMY_TEST_SKIP:
            n_tests++;
            continue;
        case DUMMY_TEST_ERROR:
            printf(_DUMMY_BG_RED _DUMMY_TX_BOLD "%d.       FAIL " _DUMMY_TX_RESET _DUMMY_TX_ITALIC "          %s %s" _DUMMY_TX_RESET " %ldns\n", i + 1, tests[i].name, tab, diff_ns);
            printf("%s\n", local_code.buffer);
            n_tests++;
            continue;
        }

        free(tab);
    }
    puts("-------------------------------------------------------------------");
    printf("Executed: %d tests\n", n_tests);
}


// void* dummy_malloc(size_t size){
//     void* ptr = malloc(size);

   
// }

// void dummy_free(void* ptr){
//     free(ptr);

// }
#endif
